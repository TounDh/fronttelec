<div class="container-xxl py-5 bg-primary hero-header mb-5">
  <div class="container my-5 py-5 px-lg-5">
    <div class="row g-5 py-5">
      <div class="col-12 text-center">
        <h1 class="text-white animated zoomIn">Service</h1>
        <hr class="bg-white mx-auto mt-0" style="width: 90px;">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-center">
            <li class="breadcrumb-item"><a class="text-white" href="#">Home</a></li>
            <li class="breadcrumb-item"><a class="text-white" href="#">Pages</a></li>
            <li class="breadcrumb-item text-white active" aria-current="page">Service</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
</div>

<!-- Service Start -->
<div class="container-xxl py-5">
  <div class="container px-lg-5">
    <div class="section-title position-relative text-center mb-5 pb-2 wow fadeInUp" data-wow-delay="0.1s">
      <h6 class="position-relative d-inline text-primary ps-4">Our Services</h6>
      <h2 class="mt-2">What Solutions We Provide</h2>
    </div>
    
    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading services...</p>
    </div>
    
    <div class="row g-4" *ngIf="!isLoading">
      <!-- Service Item Template -->
      <div class="col-lg-4 col-md-6 wow zoomIn" *ngFor="let service of services; let i = index" 
           [attr.data-wow-delay]="getAnimationDelay(i)">
        <div class="service-item d-flex flex-column justify-content-center text-center rounded">
          <div class="service-icon flex-shrink-0">
            <i [class]="getServiceIcon(service.name)"></i>
          </div>
          <h5 class="mb-3">{{ service.name }}</h5>
          <p>{{ service.description || 'Premium service with excellent features' }}</p>
          <div class="mt-auto" style="padding-left: 25%;">
            <a class="btn show-more-btn px-3 mx-2" style="width: 120px; " (click)="openServiceModal(service)">
              Details
            </a>
            <div class="col-12" style="padding-right: 25%;">
                  <hr class="my-1 border-primary">
                </div>
            <a class="btn apply-service-btn px-3 mx-2 " style="width: 120px; padding-right: 10%; " (click)="openApplyModal(service)">
              Apply Now
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Service End -->

<!-- Service Modal -->
<div class="custom-modal-backdrop" *ngIf="showServiceModal">
  <div class="custom-modal">
    <div class="custom-modal-header bg-primary text-white">
      <h5 class="modal-title">{{ selectedService?.name }}</h5>
      <button type="button" class="close-btn" (click)="closeServiceModal()">&times;</button>
    </div>
    <div class="custom-modal-body" *ngIf="selectedService">
      <h6>Description</h6>
      <p>{{ selectedService.description || 'No description available.' }}</p>
      
      <h6 *ngIf="selectedService.offers && selectedService.offers.length > 0">Available Offers</h6>
      <div class="table-responsive" *ngIf="selectedService.offers && selectedService.offers.length > 0">
        <table class="table">
          <thead class="table-header">
            <tr>
              <th>Commitment</th>
              <th>Speed</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let offer of selectedService.offers">
              <td>{{ offer.commitment || '12 Months' }}</td>
              <td>{{ offer.speed || '50-100 Mbps' }}</td>
              <td>${{ offer.price || '29.99' }}/month</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div *ngIf="!selectedService.offers || selectedService.offers.length === 0">
        <p>No offer details available for this service.</p>
      </div>
      
      <div *ngIf="selectedService.installationFees">
        <h6>Installation Fees</h6>
        <p>${{ selectedService.installationFees }}</p>
      </div>
    </div>
    <div class="custom-modal-footer">
      <button type="button" class="btn btn-secondary" (click)="closeServiceModal()">Close</button>
      <button type="button" class="btn btn-primary" (click)="openApplyModal(selectedService)">Apply Now</button>
    </div>
  </div>
</div>

<!-- Apply Service Modal -->
<div class="custom-modal-backdrop" *ngIf="showApplyModal">
  <div class="custom-modal">
    <div class="custom-modal-header bg-primary text-white">
      <h5 class="modal-title">Apply for {{ selectedService?.name }}</h5>
      <button type="button" class="close-btn" (click)="closeApplyModal()">&times;</button>
    </div>
    <div class="custom-modal-body" *ngIf="selectedService">
      <div *ngIf="!currentUser" class="alert alert-warning">
        Please <a routerLink="/login">log in</a> to apply for a service.
      </div>
      
      <div *ngIf="currentUser">
        <p><strong>User:</strong> {{ currentUser.name }} {{ currentUser.surname }}</p>
        <p><strong>Email:</strong> {{ currentUser.email }}</p>
        
        <div class="mb-3">
          <label class="form-label"><strong>Select Offer:</strong></label>
          <div *ngFor="let offer of selectedService.offers" class="form-check">
            <input class="form-check-input" type="radio" name="offerSelect" 
                   [id]="'offer'+offer.id" [value]="offer.id" 
                   [(ngModel)]="applyServiceData.offerId">
            <label class="form-check-label" [for]="'offer'+offer.id">
              {{ offer.commitment }} - {{ offer.speed }} - ${{ offer.price }}/month
            </label>
          </div>
        </div>

        <div *ngIf="selectedService.installationFees" class="alert alert-info">
          <strong>Installation Fee:</strong> ${{ selectedService.installationFees }}
        </div>
      </div>
    </div>
    <div class="custom-modal-footer">
      <button type="button" class="btn btn-secondary" (click)="closeApplyModal()">Cancel</button>
      <button type="button" class="btn btn-primary" 
              (click)="submitApplication()" 
              [disabled]="!applyServiceData.offerId || !currentUser">
        Submit Application
      </button>
    </div>
  </div>
</div>